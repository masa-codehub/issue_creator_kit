---
name: retrospective
description: Skill for conducting retrospectives using YWT and KPT. Used for (YWT) (1) deep-diving into technical failures, (2) analyzing unexpected tool/system behavior, (3) documenting key learnings from complex bug fixes; and (KPT) (1) improving task estimation and planning accuracy, (2) refining step-by-step procedures, (3) optimizing communication or tool usage workflows.
---

# 振り返り (Retrospective)

完了したタスクの成果と課題を振り返り、次のアクションを決定するためのスキル。
状況に応じて **YWT** または **KPT** を選択（あるいは併用）して実施する。

## 1. YWT (技術・タスクの深掘り)
技術的な失敗、未知の挙動、仕様の誤解などに直面した際に選択する。

- **Y (やったこと):**
  - **作業の実施内容:** 目標達成のために実際に行った具体的な作業。
  - **事象の観測:** 作業中に発生した動作、出力、およびシステムの状態変化。
  - **分析情報の集約:** 後の分析の根拠となる客観的な事実（参照したSSOTやコード、取得したログ、エラーメッセージ、確認した設定値など）の整理。
- **W (わかったこと):**
  - **結果の確認:** 手続きを実行した結果、実際に何が起きたか。
  - **ギャップ分析:** 発生した差異（ギャップ）が複数ある場合は、それぞれについて以下のフレームワークを用いて分析する。
    - **理想 (To-Be):** 本来どう動くべきだったか（仕様、設計、期待値）。
    - **現状 (As-Is):** 実際にどう動いたか（観測事実）。
    - **ギャップ (Gap):** To-BeとAs-Isの具体的な差異。
    - **要因 (Root Cause):** なぜその差異が生じたか（SSOTの誤認、環境の問題、コードのバグ、未知の仕様など）。

  - **アウトプット例 (Markdown):**
    ```markdown
    #### ギャップ分析1: [事象名A]
    - **理想 (To-Be):** `pytest` を実行すると、`test_login` がパスするはずだった。
    - **現状 (As-Is):** `test_login` が `ImportError` で失敗した。
    - **ギャップ:** テストコードのロジック以前に、モジュールのインポートに失敗している。
    - **要因:** 新しく作成したモジュールのディレクトリに `__init__.py` が不足していたため。

    #### ギャップ分析2: [事象名B]
    - **理想 (To-Be):** `replace` 実行後、ファイル `auth.py` の10行目のみが置換される想定だった。
    - **現状 (As-Is):** 意図しない20行目も同時に置換されてしまった。
    - **ギャップ:** 置換範囲が広すぎて、重複するパターンの箇所まで書き換えられた。
    - **要因:** `old_string` に十分なコンテキスト（前後の行）を含めず、一意性が不足していたため。
    ```
- **T (次やること / 仮説立案):**
  - `objective-analysis` スキルの「多角的仮説立案」に準じ、「Y」および「W」で収集した事実を根拠に3つの仮説（実証的、飛躍的、逆説的）を立てる。
  - **検証項目の策定:** 各仮説の確からしさを判断するために必要な情報（Unknowns）を特定し、次のアクション（調査、実験、ユーザーへの質問）としてリストアップする。

## 2. KPT (プロセス・効率の改善)
作業の進め方、コミュニケーション、計画の精度などに課題を感じた際に選択する。
すべての項目を **「安全性」「効率性」「コンテキスト」「合意形成」** の4軸（切り口）で分析し、構造的な改善を図る。

### 評価の切り口 (4 Axes)
1.  **安全性 (Safety):** リスク管理、副作用の防止、確認不足の有無。
2.  **効率性 (Efficiency):** ツール活用、手順の最適化、無駄の削減。
3.  **コンテキスト (Context):** 既存規約への準拠、SSOTとの整合、独自ルールの排除。
4.  **合意形成 (Alignment):** ユーザー意図の把握、早期確認、認識齟齬の防止。

- **K (Keep): 継続すべき成功パターンの事実**
  観測された事実に基づき、以下の問いを用いて再現可能な成功要因を特定する。
  - **[Safety]** どの確認手順が、致命的なミスや手戻りを防いだか？
  - **[Efficiency]** どのツール操作や手順順序が、作業時間を短縮したか？
  - **[Context]** どの既存ルールやドキュメントの参照が、品質を担保したか？
  - **[Alignment]** どのタイミングの質問や提案が、ユーザーとの認識ズレを防いだか？

- **P (Problem): 構造的な阻害要因の事実**
  観測された事実に基づき、以下の問いを用いて改善すべき真因を特定する。
  - **[Safety]** 確認不足や「だろう運転」によって生じたリスクはあったか？
  - **[Efficiency]** 冗長な操作、ツールの誤用、遠回りはなかったか？
  - **[Context]** 調査不足による独自ルールの持ち込みや、既存設計との乖離はなかったか？
  - **[Alignment]** 前提の不一致、説明不足、確認漏れによる手戻りはなかったか？

- **T (Try): 具体的な改善策と資産化 (多角的仮説立案)**
  KとPの分析結果から、`objective-analysis` スキルの「多角的仮説立案」に準じ、**「なぜうまくいったのか/いかなかったのか」**についての3つの仮説を立て、仕組みとして定着させるためのアクションを定義する。

  **アクションの決定:**
  立案した仮説の中から、**最も効果が大きく根本解決に繋がるもの**を選択し、具体的な資産化アクションへ落とし込む。
