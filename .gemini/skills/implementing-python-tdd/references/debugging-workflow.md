# Python Debugging Workflow

テストが失敗した場合や予期せぬ動作をした際に、効率的に原因を特定・修正するためのワークフロー。

## 1. 失敗箇所の特定 (Identify Failure)

まず、どのテストケースが失敗しているかを正確に把握します。

```bash
pytest -v
```

- **-v (verbose):** 実行されたテストケースごとの結果を表示します。

## 2. 失敗テストへの集中 (Focus on Failure)

失敗したテストのみを再実行し、フィードバックループを高速化します。

```bash
pytest --lf
```

- **--lf (last-failed):** 前回失敗したテストのみを実行します。

## 3. 詳細なデバッグ (Deep Dive)

エラーの原因が直感的に分からない場合は、詳細情報を出力するかデバッガを使用します。

### A. Printデバッグ

標準出力（print文）を表示して変数の状態などを確認します。

```bash
pytest --lf -s
```

- **-s:** キャプチャされた標準出力を表示します。

### B. 対話的デバッガ (PDB)

例外発生時にデバッガを起動し、その時点のコンテキストを調査します。

```bash
pytest --lf --pdb
```

- **--pdb:** テスト失敗時にPython Debuggerを起動します。
- **主なコマンド:**
  - `l` (list): 周辺のコードを表示
  - `p <var>` (print): 変数の値を表示
  - `n` (next): 次の行へ
  - `c` (continue): 処理を継続
  - `q` (quit): 終了

## 4. 修正と再実行 (Fix & Retry)

コードを修正し、再度 `pytest --lf` を実行して修正されたことを確認します。

## 5. 全体確認 (Verify All)

最後に全てのテストを実行し、リグレッション（他の箇所への悪影響）がないことを確認します。

```bash
pytest
```
