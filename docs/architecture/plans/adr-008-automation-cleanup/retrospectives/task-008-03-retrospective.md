# 振り返りレポート (KPT) - アーキテクチャ更新 (ADR-008)

## 評価の切り口 (4 Axes)
1. **安全性 (Safety):** リスク管理、副作用の防止、確認不足の有無。
2. **効率性 (Efficiency):** ツール活用、手順の最適化、無駄の削減。
3. **コンテキスト (Context):** 既存規約への準拠、SSOTとの整合、独自ルールの排除。
4. **合意形成 (Alignment):** ユーザー意図の把握、早期確認、認識齟齬の防止。

## 1. K (Keep): 継続すべき成功パターン
- **[Efficiency]:** `scouting-facts` で `definitions.md` の規定と `document.py` の実装を事前に対比させたことで、記述すべきバリデーションルールの具体性が向上した。
- **[Context]:** 既存の C4 図面やセクション構造を維持しつつ、末尾に新規セクションを追加する形で更新したため、ドキュメント全体の整合性が保たれた。
- **[Alignment]:** 案A (実証的) をベースに 案B (Mermaidでの視覚化) を組み合わせる方針を事前に監査レポートで定義し、実行した。

## 2. P (Problem): 構造的な阻害要因
- **[Context]:** Issue で指定された実装マッピング先 `src/issue_creator_kit/domain/models` が現状存在しない（`document.py` に混在している）という「理想と現実の乖離」があった。
- **[Safety]:** Mermaid 記法において、日本語を含むマルチバイト文字のレンダリングやエスケープに関する考慮が不足していた（今回はシンプルな英語表記で回避したが、複雑な図解ではリスクになる）。

## 3. T (Try): 具体的な改善策と資産化
- **立案された仮説:**
  - **実証的:** ドキュメント上のマッピング注記に「(Planned)」と記述し、現状の実装箇所も併記することで、閲覧者の混乱を防ぐ（実施済み）。
  - **飛躍的:** `src/issue_creator_kit/domain/models/` ディレクトリを作成し、`document.py` から `Metadata` モデルを切り出すリファクタリング Issue を自動生成する。
  - **逆説的:** バリデーションルールをドキュメントに「転記」するのではなく、コード上の Pydantic モデルからドキュメントを自動生成する仕組みを検討する。

### 資産化アクション
- **選択された改善策:** `domain/models` へのリファクタリング Issue の起票。
- **具体的な手順/Issue案:**
  - [ ] `drafting-issues` を使用して、`Metadata` モデルの `domain/models/metadata.py` への移動と、ADR-008 に準拠した正規表現の厳格化をタスク化する。
