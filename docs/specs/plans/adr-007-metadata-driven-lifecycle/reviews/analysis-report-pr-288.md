# 目的分析レポート (Analysis Report) - PR #288 Review Fixes

## 1. 意図の深掘り (Intent & Context)

- **ユーザーの真の目的 (Outcome):**
  - 詳細仕様書（Spec）の曖昧さを排除し、実装者が迷わずに TDD を開始できる状態にすること。
  - プロジェクトの最新決定事項（ADR-007）と仕様書を完全に同期させ、ドキュメントの信頼性を高めること。
- **背景と文脈 (Why):**
  - PR #288 のレビューにより、ロジックのステップ間におけるデータ保持の不明確さ、および旧 ADR-003 の用語・参照の残存が指摘された。これらは実装時のバグやチーム内の認識齟齬の原因となる。
- **制約条件 (Constraints):**
  - すでに進行中の PR #288 の文脈を維持しつつ、破壊的でない範囲で仕様を精緻化する必要がある。

## 2. ギャップ分析 (Gap Analysis)

- **現状 (As-Is):**
  - `creation_logic.md` にて、リンク置換後の本文を後続のステップで再利用するための明示的な記録指示が欠落している。
  - `creation_logic.md` および `promotion_logic.md` に ADR-003 の残滓（用語、参照）がある。
- **理想 (To-Be):**
  - ステップ 3 で生成された「リンク置換後の本文」が確実にバッファに保存され、ステップ 4 で書き戻されることが一貫して記述されている。
  - すべての参照が ADR-007 に統一され、用語（`ick create` 等）も最新のものになっている。
- **特定されたギャップ:**
  - 状態管理（バッファへの保存）の記述不足。
  - 設計ドキュメント間の整合性（ADR vs Spec）。

## 3. 仮説オプション (Hypothesis Options)

### 案A: 実証的仮説 (Grounded) - 本命案

_(事実に基づいた最も確実なアプローチ)_

- **アプローチ:**
  - `creation_logic.md` の Step 3.C に「link-replaced body の保存」を追記し、Step 4.1.B とリンクさせる。
  - `creation_logic.md` の Roadmap Sync 参照を ADR-007 に更新。
  - `promotion_logic.md` の Rationale を修正し、`ick create` への言及を追加。
- **メリット/デメリット:**
  - メリット: レビュアーの指摘を 100% 反映でき、実装の曖昧さが即座に解消される。
  - デメリット: 特になし。
- **リスク (4大リスク):**
  - 整合性リスク: 小。用語の微調整のみ。
- **検証の視点:**
  - `ick create` 実行時にリンク置換が正しく行われ、ファイルが `_archive/` に移動した際にその内容が反映されていること。

### 案B: 飛躍的仮説 (Leap) - 理想案

_(潜在ニーズを捉えた、より高度なアプローチ)_

- **アプローチ:**
  - 仕様書内に `Memory Buffer Schema` というセクションを独立して設け、`creation_results` の構造を JSON 等で厳密に定義する。
- **メリット/デメリット:**
  - メリット: 実装時のデータ構造の検討コストがゼロになる。
  - デメリット: 今回の小規模な修正に対してはオーバースペックの可能性がある。

### 案C: 逆説的仮説 (Paradoxical) - 代替案

_(前提を疑い、別角度から解決するアプローチ)_

- **アプローチ:**
  - `ick create` コマンド自体が冪等であれば、リンク置換後の本文を保存せずとも、書き戻し時に再計算すれば良いとする。
- **メリット/デメリット:**
  - デメリット: 再計算による API コール（Issue ID 取得など）が発生し、非効率かつ不整合のリスクがある。

## 4. 推奨される方針 (Recommendation)

- **推奨案:** 案A（実証的仮説）
- **理由:** レビュアーの意図に最も忠実であり、かつプロジェクトの現在のフェーズ（詳細設計の精緻化）において必要十分な改善であるため。
- **残存する不確実性 (Unknowns):** なし。
