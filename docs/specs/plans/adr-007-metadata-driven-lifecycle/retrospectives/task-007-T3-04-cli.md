# 振り返りレポート (YWT) - CLI Specification Update (007-T3-04)

## 1. Y (やったこと)
- **作業の実施内容:**
  - `docs/specs/api/cli_commands.md` の更新。
  - `reqs/tasks/archive/` から `reqs/tasks/_archive/` へのデフォルトパス変更。
  - `process-diff` コマンドへの `--adr-id` オプション追加と、再帰探索挙動の明記。
  - TDD Criteria の更新と、移行に関する注意書きの追加。
- **事象の観測:**
  - `cli_commands.md` の既存の記述が ADR-003 時代のままであり、ADR-007 で導入された `_archive/` というフォルダ命名規則（アンダースコア付き）と不一致だった。
- **分析情報の集約:**
  - `reqs/design/_approved/adr-007-metadata-driven-lifecycle.md`
  - `docs/specs/plans/adr-007-metadata-driven-lifecycle/definitions.md`

## 2. W (わかったこと)
- **結果の確認:**
  - 仕様書を先行して更新することで、後続の実装タスク（007-T3-04-impl）における「何を作るべきか」が明確になった。
  - 特に `_archive` のアンダースコアの有無は、自動化スクリプトにおいて重大なバグの原因になりうるため、この段階で修正できたことは有意義だった。

### ギャップ分析
- **理想 (To-Be):**
  - CLI 仕様が ADR-007 のディレクトリ構造およびメタデータ駆動の原則と完全に一致している。
- **現状 (As-Is):**
  - ADR-003 時代のパス設定（`archive/`）が残存しており、探索範囲も限定的だった。
- **ギャップ:**
  - パス命名規則の不一致（アンダースコア欠如）および、検索ロジックの定義不足（非再帰）。
- **要因 (Root Cause):**
  - ADR-007 の決定事項が CLI Spec に即座に反映されておらず、設計と仕様の間にタイムラグが生じていた。

## 3. T (次やること / 仮説立案)
- **実証的仮説:**
  - 今回更新した仕様に基づき、`src/issue_creator_kit/cli.py` を実装し、テストで検証する。
- **飛躍的仮説:**
  - CLI のヘルプメッセージやデフォルト値を、ソースコードから仕様書へ自動反映（またはその逆）する仕組みがあれば、今回のような不一致を未然に防げる。
- **逆説的仮説:**
  - パスを CLI 引数で細かく指定させるのではなく、`ick.yaml` のような設定ファイルを導入し、デフォルト設定を中央管理すべきではないか。

### 検証アクション
- [x] `grep "reqs/tasks/_archive/" docs/specs/api/cli_commands.md` でパスの正確性を確認する。
- [ ] 実装タスク（007-T3-04-impl）を起票し、今回の仕様変更を反映させる。
