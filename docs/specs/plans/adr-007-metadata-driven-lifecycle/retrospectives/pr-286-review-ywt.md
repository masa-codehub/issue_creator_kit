# 振り返りレポート (YWT)

## 1. Y (やったこと)

- **作業の実施内容:**
  - `docs/specs/api/cli_commands.md` の更新内容（PR #286）に対するレビューコメントの分析。
  - `src/issue_creator_kit/usecase/creation.py` の実装シグネチャと仕様書の TDD Criteria の比較。
  - ADR-007 (`reqs/design/_approved/adr-007-metadata-driven-lifecycle.md`) の命名規則の確認。
- **事象の観測:**
  - レビュアーから、仕様書内での UseCase メソッドシグネチャの定義漏れと、`--adr-id` 引数のフォーマット未定義について指摘を受けた。
  - レビュアーの提案（大文字 `ADR-`）が、既存の ADR 命名慣習（小文字 `adr-`）と食い違う可能性を検知した。
- **分析情報の集約:**
  - `docs/specs/api/cli_commands.md`: `adr_id` パラメータが TDD Criteria にのみ登場し、UseCase 委譲セクションに記述がない。
  - `src/issue_creator_kit/usecase/creation.py`: `create_issues_from_virtual_queue` に `adr_id` 引数が存在しない。

## 2. W (わかったこと)

- **結果の確認:**
  - CLI 仕様書において、UseCase 層へのインターフェース定義（メソッド名と引数）を曖昧にしていたため、実装との乖離やレビューでの疑義を招いた。
  - ADR ID のようなプロジェクト固有の識別子フォーマットが、ドキュメント間で暗黙的になっており、明示的なバリデーションルールとして定義されていなかった。

### ギャップ分析

- **理想 (To-Be):**
  - CLI 仕様書に、UseCase 層へ渡すべき具体的なメソッド名と引数リストが全て定義されている。
  - 外部入力（CLI引数）のフォーマットとバリデーションルールが、既存の慣習（ADR命名規則）と一貫性を持って定義されている。
- **現状 (As-Is):**
  - メソッドシグネチャの一部（`adr_id`）が欠落。
  - 引数フォーマットが未定義。
- **ギャップ:**
  - インターフェース定義の網羅性不足。
  - 命名規則の明文化不足。
- **要因 (Root Cause):**
  - 「UseCase への委譲」セクションの記述を簡略化しすぎた。
  - プロジェクト全体の共通識別子フォーマットが、実装ガイド（Guide）や ADR 以外（Spec）で再定義されていなかった。

## 3. T (次やること / 仮説立案)

- **実証的仮説:**
  - 仕様書の「UseCase への委譲」セクションにメソッドシグネチャを明記し、`--adr-id` のバリデーションルールを追加すれば、実装と仕様の同期が容易になる。
- **飛躍的仮説:**
  - ADR ID などの共通フォーマットを `docs/guides/naming-conventions.md` のような SSOT に抽出し、各 Spec からそこを参照するようにすれば、レビュアーごとの解釈のズレ（大文字 vs 小文字）を防げる。
- **逆説的仮説:**
  - ババリデーションを CLI 層ではなく UseCase 層（Domain Logic）で行うべきという考え方もあるが、ユーザーへの即時フィードバック（終了コード 1）を重視し、インターフェース層での早期バリデーションを正とする。

### 検証アクション

- [x] `docs/specs/api/cli_commands.md` に UseCase シグネチャとバリデーションルールを追記する。
- [ ] 後続の実装タスクで、UseCase のメソッドシグネチャを仕様に合わせる。
- [ ] `coding-guidelines.md` または独立したドキュメントに ADR ID の命名規則を明文化することを検討する。
