# 概要 / Summary
[ADR-003] タイトル: ロードマップおよび実装タスクのライフサイクル管理と自動化

- **Status**: 提案中
- **Date**: 2025-12-28

## 状況 / Context
ADR-002 により、設計ドキュメント（ADR/Design Doc）の承認フローは定義された。
しかし、プロジェクトの進行に伴い更新され続ける「ロードマップ」や、使い捨ての実装指示書である「タスク（Draft Issue）」は、設計ドキュメントとは異なるライフサイクルを持つ。
これらを同一の `_inbox` / `_approved` フローで扱うと、承認済みの不変な仕様と、流動的な計画・タスクが混在し、管理が複雑化する。
特にタスク（Draft Issue）は、特定のタイミング（フェーズ開始時など）で GitHub Issue として起票されるべきであり、マージされた瞬間に全て起票されるとバックログが溢れる問題がある。

## 決定 / Decision
ロードマップとタスクに対し、設計ドキュメントとは独立した専用のディレクトリ構造とライフサイクルを定義し、自動化する。

### 1. ロードマップ (Roadmap) のライフサイクル
ロードマップはプロジェクト期間中、常に更新され続ける「Mutable（可変）」なドキュメントとして扱う。

- **`reqs/roadmap/_inbox/`**: 計画策定中。
- **`reqs/roadmap/active/`**: 実行中。`_inbox` からのマージ、または直接の更新によって管理される。常に1プロジェクトにつき少数のアクティブなロードマップのみが存在する状態を保つ。
- **`reqs/roadmap/archive/`**: 完了した計画。

### 2. タスク (Tasks / Draft Issues) のライフサイクル
タスクは「いつ起票するか」を人間が制御できる必要がある。

- **`reqs/tasks/drafts/`**: 控室。将来のフェーズで使用する Draft Issue を `adr-XXX/phase-Y/` のように階層化して保管する。ここは自動化の対象外とする。
- **`reqs/tasks/_queue/`**: **【自動起票トリガー】**。人間（Architect）が `drafts` からここにファイルを移動（またはコピー）させた瞬間、GitHub Actions が検知して Issue 起票プロセスを開始する。
- **`reqs/tasks/archive/`**: 起票済み。Issue 番号が追記された状態で保管される。

### 3. 自動化ロジック (issue-kit)
- **Queue Monitor**: `reqs/tasks/_queue/` へのファイル追加（push）をトリガーとする Workflow を作成する。
- **Roadmap Linker**: Issue 起票時、Draft Issue 内のメタデータだけでなく、Roadmap ファイル内のリンクも（可能であれば）更新し、相互リンクを維持する。

## 検討した代替案 / Alternatives Considered
- **案B: ラベルによる制御**: 全て同じフォルダに置き、Git のコミットメッセージや PR ラベルで「起票するか否か」を制御する。
    - *不採用理由*: オペレーションミス（ラベル付け忘れ）のリスクが高く、フォルダによる物理的な分離の方が視認性と安全性が高い。

## 結果 / Consequences
### メリット
- フェーズごとの「小出し」の Issue 起票が可能になり、バックログが健全に保たれる。
- ロードマップの進捗状況（Active / Archive）がディレクトリ構造を見るだけで把握できる。
- 設計（不変）と計画（可変）が分離され、それぞれの性質に適した管理が可能になる。

### デメリット
- ディレクトリ構造が深くなり、手動でのファイル操作（`git mv` 等）の手間が若干増える（CLI での支援が必要）。

## 検証基準 / Verification Criteria
1. `reqs/tasks/drafts/` にあるファイルを `reqs/tasks/_queue/` に移動して Push すると、GitHub Issue が起票されること。
2. 起票後、ファイルが `reqs/tasks/archive/` に移動されていること。
3. `reqs/roadmap/_inbox/` のファイルがマージされた際、`reqs/roadmap/active/` に配置されること（または手動移動ルールが機能すること）。

## 実装状況 / Implementation Status
未着手
